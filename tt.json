{
  "version": 1,
  "name": "tt",
  "enums": [
    {
      "name": "Text roles",
      "description": "Customises allowed text roles for TT content.",
      "match": "core://text-roles",
      "values": {
        "heading-3": {"forbidden":true},
        "heading-4": {"forbidden":true},
        "vignette": {}
      }
    },
    {
      "name": "Account types",
      "description": "Defines TT-specific account types.",
      "match": "core://account-types",
      "values": {
        "tt/keycloak": {
          "description": "A keycloak user sub"
        },
        "x-imid/user": {
          "description": "Legacy Naviga user account"
        }
      }
    }
  ],
  "documents": [
    {
      "name": "Editorial info type",
      "description": "Defines an editorial info type document.",
      "declares": "tt/editorial-info-type",
      "attributes": {
        "title": {},
        "uri": {"glob":["tt://editorial-info-type/*"]}
      },
      "meta": [
        {
          "name": "Ttninjs match object",
          "description": "Declares a ttninjs match object for editorial info types.",
          "declares": {"type":"tt/ttninjs-match-object"},
          "data":{
            "npdoc.printpm": {
              "optional":true,
              "description":"Key used for setting Print PM product codes."
            }
          }
        }
      ]
    },
    {
      "name": "Grattis",
      "description": "Birthday document type.",
      "declares": "tt/grattis",
      "links": [
        {
          "name": "Old DB reference",
          "description": "Link to a legacy contact database entry.",
          "declares": {"rel":"alternate", "type":"tt/old-contact-db"},
          "attributes": {
            "uri": {"glob":["tt://kontid/*"]}
          }
        }
      ],
      "meta": [
        {"ref": "core://definition"},
        {
          "name": "Contact information",
          "description": "Contact details for the person.",
          "declares": {"type":"core/contact"},
          "count": 1,
          "data": {
            "firstName": {"optional":true},
            "lastName": {"optional":true},
            "title": {"optional":true}
          }
        },
        {
          "name": "Birthday date",
          "description": "Date of birth and optional death information.",
          "declares": {"type":"tt/birthday"},
          "count": 1,
          "attributes": {
            "value": {
              "time": "2006-01-02",
              "optional": true
            }
          },
          "data": {
            "year": {
              "format":"int",
              "optional": true
            },
            "died": {
              "time": "2006-01-02",
              "optional": true
            },
            "died_year": {
              "format":"int",
              "optional": true
            },
            "died_note": {
              "optional": true
            }
          }
        }
      ]
    },
    {
      "name": "Group",
      "description": "Extensions for group documents.",
      "match": {"type": {"const":"core/group"}},
      "links": [
        {
          "name": "Old DB reference",
          "description": "Link to a legacy contact database entry.",
          "declares": {"rel":"alternate", "type":"tt/old-contact-db"},
          "attributes": {
            "uri": {"glob":["tt://kontid/*"]}
          }
        }
      ]
    },
    {
      "name": "Author",
      "description": "Extensions for author documents.",
      "match": {"type": {"const":"core/author"}},
      "meta": [
        {
          "name": "TT contact extensions",
          "description": "TODO: why the duplicate signature/initials/short desc?",
          "match": {"type": {"const":"core/contact-info"}},
          "data": {
            "signature": {"optional":true},
            "initials": {"optional":true}
          }
        }
      ],
      "links": [
        {
          "name": "Linked keycloak account",
          "description": "Links an author to their Keycloak identity.",
          "match": {
            "rel": {"const": "same-as"},
            "type": {"const": "tt/keycloak"}
          },
          "attributes": {
            "uri": {"glob":["core://user/**"]},
            "role": {"enum": ["stage", "prod"]}
          }
        },
        {
          "name": "Linked NavigaID account",
          "description": "Links an author to their legacy NavigaID identity.",
          "match": {
            "rel": {"const": "same-as"},
            "type": {"const": "x-imid/user"}
          },
          "attributes": {
            "uri": {"glob":["imid://user/sub/*"]},
            "role": {"const": "prod"}
          }
        }
      ]
    },
    {
      "name": "Event",
      "description": "Extensions for event documents.",
      "match": {"type": {"const":"core/event"}},
      "links": [
        {
          "name": "TT Organiser",
          "description": "TODO: is this good data, or just noise?",
          "declares": {"rel":"organiser", "type":"tt/organiser"},
          "attributes": {
            "uri": {},
            "title": {}
          }
        },
        {
          "name": "TT Participant",
          "description": "TODO: is this good data, or just noise?",
          "declares": {"rel":"participant", "type": "tt/participant"},
          "attributes": {
            "uri": {},
            "title": {}
          }
        }
      ]
    },
    {
      "name": "Category",
      "description": "Extensions for category documents using IPTC mediatopics.",
      "match": {"type": {"const":"core/category"}},
      "attributes": {
        "uri": {
          "glob": ["iptc://mediatopic/*"]
        }
      },
      "links": [
        {
          "name": "IPTC mediatopic",
          "description": "Same-as link to the IPTC mediatopic identifier.",
          "declares": {"type":"iptc/mediatopic", "rel":"same-as"},
          "attributes": {
            "uri": {
              "glob": ["iptc://mediatopic/*"]
            }
          },
          "data": {
            "id": {"format":"int"}
          }
        }
      ]
    },
    {
      "name": "Organisation",
      "description": "Extensions for organisation documents.",
      "match": {"type": {"const":"core/organisation"}},
      "meta": [
        {
          "name": "Organisation type",
          "description": "Specifies the type of the organisation.",
          "declares": {"type":"tt/type"},
          "attributes": {
            "value": {}
          }
        }
      ]
    },
    {
      "name": "Flash",
      "description": "Extensions for flash news documents.",
      "match": {"type": {"const":"core/flash"}},
      "links": [
        {
          "name": "Section",
          "description": "Required section for flash documents.",
          "match": {
            "rel": {"const":"section"},
            "type": {"const":"core/section"}
          },
          "minCount": 1
        }
      ]
    },
    {
      "name": "Editorial info",
      "description": "Extensions for editorial info documents.",
      "match": {"type": {"const":"core/editorial-info"}},
      "meta": [
        {
          "ref": "tt://slugline",
          "count": 1
        }
      ],
      "links": [
        {
          "name": "Section",
          "description": "Required section for editorial info documents.",
          "match": {
            "rel": {"const":"section"},
            "type": {"const":"core/section"}
          },
          "minCount": 1
        },
        {
          "name": "Editorial-info type",
          "description": "Specifies the editorial-info type",
          "declares": {"type": "tt/editorial-info-type", "rel": "info-type"},
          "attributes": {
            "uuid": {}
          }
        },
        {
          "name": "Alternate ID",
          "description": "TODO: is this actually used for live data? See stage/df6ebaba-b3fc-40ff-9ad2-19f953eb0c6a",
          "declares": {"type": "tt/alt-id", "rel": "alternate"},
          "attributes": {
            "uri": {}
          }
        }
      ],
      "content": [
        {"ref": "tt://visual"}
      ]
    },
    {
      "name": "Article",
      "description": "Extensions for article documents.",
      "match": {"type": {"const":"core/article"}},
      "links": [
        {
          "name": "Section",
          "description": "Required section for article documents.",
          "match": {
            "rel": {"const":"section"},
            "type": {"const":"core/section"}
          },
          "minCount": 1
        },
        {
          "name": "Same as TT event",
          "description": "Old data from OpenContent",
          "declares": {"rel":"same-as", "type": "tt/event"},
          "attributes": {
            "uri": {"glob":["tt://event/*"]}
          },
          "data": {
            "id": {}
          },
          "deprecated": {
            "label": "article-as-event",
            "doc": "Strange data migrated from old CMS"
          }
        },
        {
          "name": "Subtype",
          "description": "Specifies the article subtype.",
          "declares": {"rel":"subtype"},
          "attributes": {
            "uri": {"glob": ["tt://subtype/*"]}
          }
        },
        {
          "name": "Content size",
          "description": "Specifies the content sizes we can use",
          "match": {
            "type": {"const":"core/content-size"}
          },
          "attributes": {
            "uri": {"enum":[
              "core://content-size/article/medium"
            ]}
          }
        },
        {
          "name": "Alternate ID",
          "description": "TODO: is this actually used for live data? See stage/df6ebaba-b3fc-40ff-9ad2-19f953eb0c6a",
          "declares": {"type": "tt/alt-id", "rel": "alternate"},
          "attributes": {
            "uri": {}
          }
        }
      ],
      "content": [
        {
          "name": "Dateline",
          "description": "Deprecated in favour of vignette",
          "declares": {"type":"tt/dateline"},
          "data": {"text":{"allowEmpty":true}},
          "deprecated": {
            "label": "dateline",
            "doc": "Use core/text vignette instead"
          }
        },
        {
          "name": "Question",
          "description": "A question block with HTML-formatted text.",
          "declares": {"type":"tt/question"},
          "data": {
            "text": {
              "allowEmpty":true,
              "format": "html"
            }
          }
        },
        {"ref": "tt://visual"}
      ],
      "meta": [
        {
          "ref": "tt://slugline",
          "count": 1
        },
        {
          "name": "Sector",
          "declares": {"type":"tt/sector"},
          "description": "TODO: what is sector?",
          "attributes": {
            "value": {
              "labels": ["keyword"]
            }
          },
          "deprecated": {
            "label": "tt-sector",
            "doc": "Use core/section instead"
          }
        }
      ]
    }
  ],
  "meta": [
    {
      "id": "tt://slugline",
      "block": {
        "name": "Slugline",
        "description": "A short keyword label used for identifying the story.",
        "declares": {"type":"tt/slugline"},
        "attributes": {
          "value": {
            "labels": ["keyword", "prefix"],
            "hints": {"alias": ["slug"]}
          }
        }
      }
    }
  ],
  "content": [
    {
      "id": "tt://visual",
      "block": {
        "name": "TT visual element",
        "description": "This can be either a picture or a graphic",
        "declares": {"type":"tt/visual"},
        "data": {
          "caption": {"allowEmpty":true},
          "html_caption": {
            "format": "html",
            "allowEmpty": true,
            "optional": true
          }
        },
        "meta": [
          {"ref": "core://softcrop"}
        ],
        "links": [
          {
            "name": "Self-link",
            "description": "Self-link pointing to the picture or graphic resource.",
            "declares": {"rel":"self"},
            "attributes": {
              "uri": {},
              "url": {},
              "type": {
                "enum": ["tt/picture", "tt/graphic"]
              }
            },
            "data": {
              "credit": {"allowEmpty":true},
              "height": {"format":"int"},
              "width": {"format":"int"},
              "hiresScale": {
                "format": "float",
                "optional": true,
                "deprecated": {
                  "label": "hires-scale",
                  "doc": "Not supported anymore"
                }
              }
            }
          }
        ]
      }
    }
  ]
}
